<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome to AbilityAssist</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        /* Custom CSS */
        body {
            font-family: 'Poppins', sans-serif; /* Exotic font */
            background-color: #f0f0f0; /* Light gray background */
            color: #333;
            margin: 0;
            padding: 0;
        }

        footer {
            background-color: #333;
            color: #ffc107;
            text-align: center;
            padding: 20px 0;
        }

        #map-container {
            width: 100%;
            height: 400px; /* Adjust height as needed */
        }

        .navbar-brand,
        .nav-link {
            font-family: 'Raleway', sans-serif; /* Exotic font */
            color: #fff; /* White color */
        }

        .navbar-dark .navbar-toggler-icon {
            background-color: #fff; /* White color */
        }

        .navbar-dark .navbar-nav .nav-link {
            color: #fff; /* White color */
        }

        .navbar-dark .navbar-nav .nav-link:hover {
            color: #ffc107; /* Yellow color on hover */
        }

        .dropdown-menu {
            font-family: 'Raleway', sans-serif; /* Exotic font */
            background-color: #333; /* Dark background */
        }

        .dropdown-item {
            color: #fff; /* White color */
        }

        .dropdown-item:hover {
            background-color: #ffc107; /* Yellow color on hover */
        }

        h2 {
            font-family: 'Montserrat', sans-serif; /* Exotic font */
            color: #333; /* Dark gray color */
        }

        p {
            font-family: 'Poppins', sans-serif; /* Exotic font */
            color: #666; /* Light gray color */
        }

        .form-control {
            border-color: #ffc107; /* Yellow color for form input border */
        }

        .btn-primary {
            background-color: #ffc107; /* Yellow color for primary button */
            border-color: #ffc107; /* Yellow color for primary button border */
        }

        .btn-primary:hover {
            background-color: #e0a800; /* Darker yellow color on hover */
            border-color: #e0a800; /* Darker yellow color on hover */
        }

        .btn-danger {
            background-color: #dc3545; /* Red color for danger button */
            border-color: #dc3545; /* Red color for danger button border */
        }

        .btn-danger:hover {
            background-color: #c82333; /* Darker red color on hover */
            border-color: #c82333; /* Darker red color on hover */
        }

        .user-icon {
            margin-right: 5px;
        }
    </style>
</head>
<body>

<header>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="#">AbilityAssist</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'index' %}">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'about' %}">About</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'contact' %}">Contact</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Help</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                           data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            {% if user.is_authenticated %}
                                <i class="fas fa-user user-icon"></i>{{ user.username }}
                            {% else %}
                                Login to your Account
                            {% endif %}
                        </a>
                        <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                            {% if user.is_authenticated %}
                                <a class="dropdown-item" href="{% url 'edit_profile' %}">Edit Profile</a>
                                <a class="dropdown-item" href="{% url 'travel_history' %}">Check search history</a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="{% url 'logout' %}">Log Out</a>
                            {% else %}
                                <a class="dropdown-item" href="{% url 'login' %}">Login</a>
                                <a class="dropdown-item" href="{% url 'register' %}">Register</a>
                            {% endif %}
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

<div class="container mt-5">
    <div class="row">
        <div class="col-md-12">
            <h2>About AbilityAssist</h2>
            <p>AbilityAssist is a company dedicated to providing assistance to people with disabilities. Our mission
                is to make the world more accessible and inclusive for everyone. Whether it's finding accessible routes
                or providing support services, we are committed to empowering individuals with disabilities.</p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <div id="map-container"></div>
            <hr>
            <form id="destinationForm">
                <div class="form-group">
                    <label for="destinationInput">Enter End Destination:</label>
                    <input type="text" class="form-control" id="destinationInput" placeholder="Enter destination">
                </div>
                <button type="submit" class="btn btn-primary">Calculate Distance</button>
                <button type="button" class="btn btn-danger mt-2" id="cancelTrip">Cancel Trip</button>
            </form>
            <div id="distanceResult" class="mt-3"></div>
        </div>
    </div>
</div>

<footer>
    <div class="container">
        <p>&copy; 2024 AbilityAssist</p>
    </div>
</footer>

<!-- Bootstrap JS -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

<!-- Google Maps JavaScript API with Places Autocomplete library -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAWgNkwf11_tis-7MTs4dI-Dvm-e5EX-MA&callback=initMap&libraries=places" async defer></script>

<!-- Custom JavaScript -->
<script>
    var map;

    function initMap() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (position) {
                var userLocation = {
                    lat: position.coords.latitude,
                    lng: position.coords.longitude
                };

                map = new google.maps.Map(document.getElementById('map-container'), {
                    zoom: 12,
                    center: userLocation
                });

            }, function () {
                handleLocationError(true);
            });
        } else {
            handleLocationError(false);
        }

        // Initialize Autocomplete for destination input
        var input = document.getElementById('destinationInput');
        var autocomplete = new google.maps.places.Autocomplete(input);
        autocomplete.bindTo('bounds', map);
    }

    function handleLocationError(browserHasGeolocation) {
        var errorMessage = browserHasGeolocation ?
            'Error: The Geolocation service failed.' :
            'Error: Your browser doesn\'t support geolocation.';
        console.error(errorMessage);
    }

    document.getElementById('destinationForm').addEventListener('submit', function (event) {
        event.preventDefault();
        calculateDistance();
    });

    document.getElementById('cancelTrip').addEventListener('click', function () {
        document.getElementById('destinationInput').value = '';
        document.getElementById('distanceResult').innerHTML = '';
    });

    function calculateDistance() {
        var destination = document.getElementById('destinationInput').value;
        var geocoder = new google.maps.Geocoder();

        geocoder.geocode({'address': destination}, function (results, status) {
            if (status === 'OK' && results[0]) {
                var destinationLocation = results[0].geometry.location;

                // Clear existing markers on the map
                clearMarkers();

                // Add marker for the new destination location
                var marker = new google.maps.Marker({
                    map: map,
                    position: destinationLocation
                });

                // Fit map to the new bounds
                var bounds = new google.maps.LatLngBounds();
                bounds.extend(destinationLocation);
                map.fitBounds(bounds);

                var distanceService = new google.maps.DistanceMatrixService();
                distanceService.getDistanceMatrix({
                    origins: [map.getCenter()],
                    destinations: [destinationLocation],
                    travelMode: 'WALKING'
                }, function (response, status) {
                    if (status === 'OK') {
                        var distance = response.rows[0].elements[0].distance.text;
                        document.getElementById('distanceResult').innerHTML = '<p>Shortest Distance: ' + distance + '</p>';
                    } else {
                        document.getElementById('distanceResult').innerHTML = '<p>Unable to calculate distance</p>';
                    }
                });
            } else {
                document.getElementById('distanceResult').innerHTML = '<p>Invalid destination</p>';
            }
        });
    }

    function clearMarkers() {
        // Clear all markers on the map
        for (var i = 0; i < markers.length; i++) {
            markers[i].setMap(null);
        }
        markers = [];
    }
</script>

</body>
</html>
